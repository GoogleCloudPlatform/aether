(DEFINE_MODULE
  (NAME test_enum_match)
  (CONTENT
    (DEFINE_ENUMERATION_TYPE
      (NAME Result)
      (VARIANTS
        (VARIANT Ok (HOLDS INTEGER))
        (VARIANT Error (HOLDS STRING))))
    
    (DEFINE_FUNCTION
      (NAME process_result)
      (ACCEPTS_PARAMETER (NAME "result") (TYPE Result))
      (RETURNS STRING)
      (BODY
        (RETURN_VALUE 
          (MATCH_EXPRESSION result
            (CASE (Ok value)
              (STRING_CONCAT "Success: " (TO_STRING value)))
            (CASE (Error msg)
              (STRING_CONCAT "Error: " msg))))))
    
    (DEFINE_FUNCTION
      (NAME main)
      (RETURNS INTEGER)
      (BODY
        (DECLARE_VARIABLE (NAME ok_result) (TYPE Result))
        (ASSIGN
          (TARGET_VARIABLE ok_result)
          (SOURCE_EXPRESSION (Ok 42)))
        
        (DECLARE_VARIABLE (NAME result_str) (TYPE STRING))
        (ASSIGN
          (TARGET_VARIABLE result_str)
          (SOURCE_EXPRESSION (CALL_FUNCTION process_result ok_result)))
        
        ; Just return 0 for now to test compilation
        (RETURN_VALUE 0)))
  )
)