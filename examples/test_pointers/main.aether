;; Test program for pointer operations

(module test_pointers
    ;; External function declarations
    (extern print_int (integer) void)
    (extern print_string (string) void)
    
    ;; Test address-of and dereference
    (function test_address_of () void
        (let ((x 42)
              (ptr (ADDRESS_OF x)))
            (print_string "Original value: ")
            (print_int x)
            (print_string "\nDereferenced value: ")
            (print_int (DEREFERENCE ptr))
            (print_string "\n")))
    
    ;; Test pointer arithmetic  
    (function test_pointer_arithmetic () void
        (let ((x 10)
              (y 20)
              (z 30))
            (let ((ptr (ADDRESS_OF x))
                  (ptr2 (POINTER_ADD ptr 1)))
                (print_string "Value at ptr: ")
                (print_int (DEREFERENCE ptr))
                (print_string "\nValue at ptr+1: ")
                (print_int (DEREFERENCE ptr2))
                (print_string "\n"))))
    
    ;; Main function
    (function main () integer
        (print_string "Testing pointer operations:\n\n")
        (test_address_of)
        (test_pointer_arithmetic)
        0))